{
    "Toolbox": {

        "Blocks": [
        {
            "ID": "Update Timestep",
            "Name": "Update Timestep",
            "Description": "Updates the current timestep value",
            "Domain": ["t"],
            "Codomain": ["t"]
        },
        {
            "ID": "Get Gradients",
            "Name": "Get Gradients",
            "Description": "Computes the gradients",
            "Domain": ["theta"],
            "Codomain": ["g"]
        },
        {
            "ID": "Update Biased First Moment",
            "Name": "Update Biased First Moment",
            "Description": "Updates the biased first moment estimate",
            "Domain": ["m", "g"],
            "Codomain": ["m"]
        },
        {
            "ID": "Update Biased Second Moment",
            "Name": "Update Biased Second Moment",
            "Description": "Updates the biased second moment estimate",
            "Domain": ["v", "g"],
            "Codomain": ["v"]
        },
        {
            "ID": "Compute Bias-Corrected First Moment",
            "Name": "Compute Bias-Corrected First Moment",
            "Description": "Computes the bias-corrected first moment estimate",
            "Domain": ["m", "t"],
            "Codomain": ["m"]
        },
        {
            "ID": "Compute Bias-Corrected Second Moment",
            "Name": "Compute Bias-Corrected Second Moment",
            "Description": "Computes the bias-corrected second moment estimate",
            "Domain": ["v", "t"],
            "Codomain": ["v"]
        },
        {
            "ID": "Update Theta",
            "Name": "Update Theta",
            "Description": "Updates model parameters based on bias-corrected moment estimates",
            "Domain": ["m", "v", "theta"],
            "Codomain": ["theta"]
        }
        ]
    },
    "Workbench": {
        "Processors": [

            {
              "ID": "Increment Timestep",
              "Name": "Increment Timestep",
              "Description": "Increments t by 1",
              "Parent": "Update Timestep",
              "Ports": ["t"],
              "Terminals": ["t"]
          },
            {
              "ID": "Get Function Gradients",
              "Name": "Get Function Gradients",
              "Description": "Computes the gradients of a function which respect to theta. $g_t$ ← $∇_θf_t(θ_{t−1})$",
              "Parent": "Get Gradients",
              "Ports": ["theta"],
              "Terminals": ["g"]
          },
          {
            "ID": "Exponential Smoothing First Moment",
            "Name": "Exponential Smoothing First Moment",
            "Description": "Updates the first moment estimate using exponential smoothing with beta1 parameter. $m_t$ ← $β_1$ · $m_{t-1}$ + (1 − $β_1$) · $g_t$ ",
            "Parent": "Update Biased First Moment",
            "Ports": ["m", "g"],
            "Terminals": ["m"]
        },
        {
            "ID": "Exponential Smoothing Second Moment",
            "Name": "Exponential Smoothing Second Moment",
            "Description": "Updates the second moment estimate using exponential smoothing with beta2 parameter. $v_t$ ← $β_2$ · $v_{t-1}$ + (1 − $β_2$) · $g_t^2$",
            "Parent": "Update Biased Second Moment",
            "Ports": ["v", "g"],
            "Terminals": ["v"]
        },
        {
            "ID": "Exponential Decay First Moment Bias Correction",
            "Name": "Exponential Decay First Moment Bias Correction",
            "Description": "Computes the bias-corrected first moment estimate using exponential decay. $\\hat{m}_t$ ← $m_t$ / (1 − $\\beta_1^t$)",
            "Parent": "Compute Bias-Corrected First Moment",
            "Ports": ["m", "t"],
            "Terminals": ["m"]
        },
        {
            "ID": "Exponential Decay Second Moment Bias Correction",
            "Name": "Exponential Decay Second Moment Bias Correction",
            "Description": "Computes the bias-corrected second moment estimate using exponential decay. $\\hat{v}_t$ ← $v_t$ / (1 − $\\beta_2^t$)",
            "Parent": "Compute Bias-Corrected Second Moment",
            "Ports": ["v", "t"],
            "Terminals": ["v"]
        },
        {
            "ID": "ADAM Theta Update",
            "Name": "ADAM Theta Update",
            "Description": "Updates model parameters using ADAM formula: $θ_t$ ← $θ_{t-1} - α · \\hat{m}_t / (\\sqrt{\\hat{v}_t} + ϵ)$",
            "Parent": "Update Theta",
            "Ports": ["m", "v", "theta"],
            "Terminals": ["theta"]
        }

      
        ],
        "Wires": [
  {
    "ID": "W5",
    "Parent": "m",
    "Source": {"Processor": "Exponential Decay First Moment Bias Correction", "Index": 0},
    "Target": {"Processor": "ADAM Theta Update", "Index": 0}
},
{
    "ID": "W6",
    "Parent": "v",
    "Source": {"Processor": "Exponential Decay Second Moment Bias Correction", "Index": 0},
    "Target": {"Processor": "ADAM Theta Update", "Index": 1}
},
{
    "ID": "W7",
    "Parent": "t",
    "Source": {"Processor": "Increment Timestep", "Index": 0},
    "Target": {"Processor": "Exponential Decay First Moment Bias Correction", "Index": 1}
},
{
    "ID": "W8",
    "Parent": "t",
    "Source": {"Processor": "Increment Timestep", "Index": 0},
    "Target": {"Processor": "Exponential Decay Second Moment Bias Correction", "Index": 1}
},
{
    "ID": "W9",
    "Parent": "m",
    "Source": {"Processor": "Exponential Smoothing First Moment", "Index": 0},
    "Target": {"Processor": "Exponential Decay First Moment Bias Correction", "Index": 0}
},
{
    "ID": "W10",
    "Parent": "v",
    "Source": {"Processor": "Exponential Smoothing Second Moment", "Index": 0},
    "Target": {"Processor": "Exponential Decay Second Moment Bias Correction", "Index": 0}
},
{
    "ID": "W11",
    "Parent": "g",
    "Source": {"Processor": "Get Function Gradients", "Index": 0},
    "Target": {"Processor": "Exponential Smoothing First Moment", "Index": 1}
},
{
    "ID": "W12",
    "Parent": "g",
    "Source": {"Processor": "Get Function Gradients", "Index": 0},
    "Target": {"Processor": "Exponential Smoothing Second Moment", "Index": 1}
},
{
    "ID": "W13",
    "Parent": "theta",
    "Source": {"Processor": "ADAM Update Step", "Index": 0},
    "Target": {"Processor": "Theta Convergence Criteria", "Index": 3}
},
{
    "ID": "W14",
    "Parent": "m",
    "Source": {"Processor": "ADAM Update Step", "Index": 1},
    "Target": {"Processor": "Theta Convergence Criteria", "Index": 0}
},
{
    "ID": "W15",
    "Parent": "v",
    "Source": {"Processor": "ADAM Update Step", "Index": 2},
    "Target": {"Processor": "Theta Convergence Criteria", "Index": 1}
},
{
    "ID": "W16",
    "Parent": "t",
    "Source": {"Processor": "ADAM Update Step", "Index": 3},
    "Target": {"Processor": "Theta Convergence Criteria", "Index": 2}
},
{
    "ID": "W17",
    "Parent": "theta",
    "Source": {"Processor": "Theta Convergence Criteria", "Index": 3},
    "Target": {"Processor": "ADAM Update Step", "Index": 0}
},
{
    "ID": "W18",
    "Parent": "m",
    "Source": {"Processor": "Theta Convergence Criteria", "Index": 0},
    "Target": {"Processor": "ADAM Update Step", "Index": 1}
},
{
    "ID": "W19",
    "Parent": "v",
    "Source": {"Processor": "Theta Convergence Criteria", "Index": 1},
    "Target": {"Processor": "ADAM Update Step", "Index": 2}
},
{
    "ID": "W20",
    "Parent": "t",
    "Source": {"Processor": "Theta Convergence Criteria", "Index": 2},
    "Target": {"Processor": "ADAM Update Step", "Index": 3}
}
        ],
        "Systems": [

        {
            "ID": "ADAM Update Step System",
            "Name": "ADAM Update Step System",
            "Description": "A single iteration of the ADAM optimization algorithm",
            "Processors": [
                "Get Function Gradients",
                "Exponential Smoothing First Moment",
                "Exponential Smoothing Second Moment",
                "Increment Timestep",
                "Exponential Decay First Moment Bias Correction",
                "Exponential Decay Second Moment Bias Correction",
                "ADAM Theta Update"
            ],
            "Wires": ["W5", "W6", "W7", "W8", "W9", "W10", "W11", "W12"]
        }
        ]
    }
}
